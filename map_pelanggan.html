<script>
var map = L.map('map').setView([-7.189, 112.28], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap'
}).addTo(map);

function warnaHari(hari) {
  if (hari == 'A') return 'red';
  if (hari == 'B') return 'blue';
  if (hari == 'C') return 'green';
  return 'orange';
}

fetch('pelanggan_pln.geojson')
.then(res => res.json())
.then(data => {

  const titik = L.geoJSON(data, {
    pointToLayer: function(feature, latlng) {
      return L.circleMarker(latlng, {
        radius: 6,
        fillColor: warnaHari(feature.properties["HARI BACA"]),
        color: '#000',
        weight: 1,
        fillOpacity: 0.8
      });
    },
    onEachFeature: function (feature, layer) {
      let p = feature.properties;

      let popup = `
        <b>IDPEL:</b> ${p.IDPEL}<br>
        <b>Nama:</b> ${p.NAMA}<br>
        <b>Hari Baca:</b> ${p["HARI BACA"]}<br>
        <b>Alamat:</b> ${p.ALAMAT}<br>
        <b>Daya:</b> ${p.DAYA} VA<br>
        <b>Gardu:</b> ${p.GARDU}<br><br>
        <a target="_blank"
        href="https://www.google.com/maps/dir/?api=1&destination=${feature.geometry.coordinates[1]},${feature.geometry.coordinates[0]}">
        ðŸ§­ Rute ke lokasi
        </a>
      `;

      layer.bindPopup(popup);
    }
  }).addTo(map);

  // ðŸ”¥ INI KUNCI SUPAYA TIDAK DUNIA DOANG
  map.fitBounds(titik.getBounds());

})
.catch(err => console.error(err));
</script>
